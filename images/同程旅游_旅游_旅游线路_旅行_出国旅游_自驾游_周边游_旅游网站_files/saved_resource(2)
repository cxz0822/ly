/*from tccdn minify at 2016-3-31 14:20:30,file：/cn/public/module/mNotice/0.4.6/mNotice.js?v=2015121701*/
!function(c){function d(R){function T(e){var f=!0,g=c.all(e);return g.length?(g.each(function(h){return c.one(h).hasClass("none")||"none"===h.style.display?void 0:(f=!1,!1)}),f):1}function V(e){var f;return(f=ag.apply(aA,[e,ac]))?(aF.html(""),aF.html(f),void (aG=!0)):void (aG=!1)}function X(f,g){var h,i;return aC||af(aA),(i=ag.apply(aA,[f,ac]))?(aF=Z(i,g),aG=!0,"mTab"===ae&&ab(ae,aA,g),ad(aA,aF),ai&&ah(aF,aA),ak&&(aj(aF),al(aF)),ap(aA,aF),an(aF,aA),h=c.one(".mNotice-close",aF),void (h.length&&aF.on("click",function(e){var j=c.getTarget(e);c.one(j).hasClass("mNotice-close")&&aF.addClass("none")}))):void (aG=!1)}function Z(e,f){aF=document.createElement("div");var g=c.one(aF);return aB&&g.attr("data-box-type",aB),aF.id="mNotice-"+f,aF.className=ao?"mNotice-wrap none "+ao:"mNotice-wrap none",g.css("position: absolute; z-index: 2000;"),document.body.insertBefore(aF,document.body.firstChild),aF.innerHTML=e,fish.one(aF).html("top",'<span class="mNotice-arrows"></span>'),g}function ab(e,f,g){"mTab"===e&&c.one("#mNotice-"+g).mTab({tab_tray:".mNotice-mTab-tab-tray",append:"current",content:".mNotice-mTab-content",fn:function(){au()}})}function ad(e,f){e.on(aD,function(b){c.all("body .mNotice-wrap").addClass("none"),aG&&T(at)&&(f.removeClass("none"),ar(f,e,S))})}function af(b){b.on("click",function(e){b[0].select()})}function ah(e,f){e.on(aE,function(b){var g=c.getTarget(b);c.one(g).hasClass("mNotice-normal")&&(f.val(g.innerHTML),f.attr("cid",g.getAttribute("cid")),f.attr("ctype",g.getAttribute("ctype")),f.addClass("color-normal"),e.addClass("none"),aB&&setTimeout(function(){c.dom("#"+aB).blur()},20),am&&am.apply(c.one(g),[f]))})}function aj(e){e.on("mouseover",function(b){var f=c.getTarget(b);c.one(f).hasClass("mNotice-normal")&&(c.all(".mNotice-normal",e).removeClass("mNotice-hover"),c.one(f).addClass("mNotice-hover"))})}function al(e){e.on("mouseout",function(b){c.all(".mNotice-normal",e).removeClass("mNotice-hover")})}function an(e,f){c.one(document).on("mousedown",function(b){for(var g=c.getTarget(b);null!==g;){if(1===g.nodeType&&(g===f[0]||g.className.indexOf("mNotice-wrap")>-1)){return void fish.one(g).attr("data-box-type")}g=g.parentNode}e.addClass("none")})}function ap(e,f){e.on("keydown",function(g){g=c.getEvent(g),key=g.keyCode||g.which,"number"==typeof key&&17!==key&&18!==key&&f.addClass("none")})}function ar(l,m,n){var n=n;if(l&&1===l[0].nodeType&&m&&1===m[0].nodeType){l.css("left:-1000px;");var o,p=c.one(window).width(),q=(c.one(window).height(),m.width()),r=m.height(),s=l.width(),t=(l.height(),m.offset()),u=(c.one(document).scrollTop(),c.one(document).scrollLeft());n&&!aw(n)?(n.x="number"==typeof n.x?n.x:0,n.y="number"==typeof n.y?n.y:0):n={x:0,y:0},(o=t.left-u)>p-(t.left-u)&&p-(t.left-u)<s?l.css("left:"+(t.left+q-s-n.x)+"px"):l.css("left:"+(t.left+n.x)+"px"),l.css("top:"+(t.top+r+n.y)+"px")}else{ar(aF,aA,n)}}function au(){aF&&!aF.hasClass("none")&&(a&&clearTimeout(a),a=setTimeout(function(){ar(aF,aA,S)},100))}function aw(e){for(var f in e){return !1}return !0}function ay(b){window.iError||(window.iError=[]),window.iError.push({date:(new Date).toString(),info:b})}var az=fish.guid();if(!R){throw new Error("传递设置参数！")}var aA=R.beside,aB=R.dataBoxType,aC=R.isSelect,aD=R.documentCaptureEvent?R.documentCaptureEvent:"focus",aE=R.inputCaptureEvent?R.inputCaptureEvent:"click";if(this.length){aA=c.one(this[0])}else{if(!aA||"string"!=typeof aA&&1!==aA.nodeType&&!aA.length){throw new Error("指定需要弹框的节点选择器或节点！")}if(aA=c.one(aA),!aA.length){throw new Error("指定需要弹框的节点！")}}var aF,aG,a,S={x:0,y:0},U=R.offset&&R.offset.x,W=R.offset&&R.offset.y,Y=R.request,aa=R.localData,ac="string"==typeof R.template?R.template:void 0,ae="mTab"===R.mode?"mTab":"",ag=R.display,ai=void 0===R.isClick?!1:!!R.isClick,ak=void 0===R.isHover?!1:!!R.isHover,am="function"==typeof R.clickCallback?R.clickCallback:!1,ao="string"==typeof R.theme?R.theme:"",aq="function"==typeof R.urlInTime?R.urlInTime:!1,at="string"==typeof R.rejects?R.rejects:!1,av="",ax={};if(R.offset&&(parseInt(U)||parseInt(W))&&(U&&(S.x=U),W&&(S.y+=W)),!R.display&&"function"!=typeof R.display){throw new Error("指定数据渲染函数！")}if(!Y&&!aa||Y&&aa){throw new Error("指定唯一数据源！")}return Y&&aq?(av=Y.url,Y.url=aq(av),Y.fn=function(e){!e||!e.length&&aw(e)||c.ready(function(){ax[Y.url.substring(Y.url.indexOf("?")+1)]=e,c.all("#mNotice-"+az).length?V(e):X(e,az)})},Y.onTimeout=function(){ay("服务器端响应超时！")},Y.err=function(){ay("服务器端发生错误！")},c.ajax(Y)):c.ready(function(){!aa||!aa.length&&aw(aa)||X(aa,az)}),c.ready(function(){c.one(window).on("resize",au)}),{show:function(){setTimeout(function(){aG&&T(at)&&aF.removeClass("none")&&ar(aF,aA,S)},0)},hide:function(){aF&&aF.length&&aF.addClass("none")},position:ar,update:function(e){if(e){V(e),ab(ae,aA,az)}else{var f;Y.url=aq(av),f=Y.url.substring(Y.url.indexOf("?")+1),ax[f]?V(ax[f]):c.ajax(Y)}}}}c.extend({mNotice:d})}(fish);